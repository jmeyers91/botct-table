(this["webpackJsonpbotct-table"]=this["webpackJsonpbotct-table"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(6),i=n.n(r),o=(n(14),n(7)),l=n(4),u=n(8),s=n(3),f=n(18),b=(n(15),"botct_state_".concat(1)),m=localStorage.getItem(b)||{players:[],showTable:!1};function d(e){var t=e.width,n=e.height;return{x:t/2,y:n/2,radius:Math.min(t,n)/2-200}}function h(e,t){var n=d(e),a=t.length;return t.map((function(e,t){return{player:e,x:n.x+(n.radius+50)*Math.cos(2*Math.PI/a*t),y:n.y+(n.radius+50)*Math.sin(2*Math.PI/a*t)}}))}function g(e,t){var n=t.x-e.x,a=t.y-e.y;return Math.sqrt(n*n+a*a)}m&&"string"===typeof m&&(m=JSON.parse(m));var p=function(){var e=Object(a.useState)(m.showTable),t=Object(s.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(m.players),p=Object(s.a)(i,2),y=p[0],v=p[1],O=Object(a.useState)(null),k=Object(s.a)(O,2),j=k[0],w=k[1],E=Object(a.useMemo)((function(){return j&&j.getContext("2d")}),[j]),C=Object(a.useCallback)((function(){v((function(e){return[].concat(Object(u.a)(e),[{id:Object(f.a)(),name:"",dead:!1}])}))}),[]),x=Object(a.useCallback)((function(e){v((function(t){return t.filter((function(t){return t.id!==e}))}))}),[]),P=Object(a.useCallback)((function(e,t){v((function(n){return n.map((function(n){return n.id===e?Object(l.a)(Object(l.a)({},n),{},{name:t}):n}))}))}),[]),T=Object(a.useCallback)((function(){return r((function(e){return!e}))}),[]),S=Object(a.useCallback)((function(e){if(j){var t=h(j,y),n=function(e,t){var n=e.getBoundingClientRect(),a=n.left,c=n.top,r=n.width,i=n.height,o=e.width/r,l=e.height/i;return{x:(t.clientX-a)*o,y:(t.clientY-c)*l}}(j,e),a=t.map((function(e){return{playerPosition:e,distance:g(e,n)}})).sort((function(e,t){return e.distance-t.distance})),c=Object(s.a)(a,1)[0];if(c&&c.distance<50){var r=c.playerPosition.player;v(y.map((function(e){return e.id===r.id?Object(l.a)(Object(l.a)({},e),{},{dead:!e.dead}):e})))}}}),[j,y]),M=Object(a.useCallback)((function(){if(j){var e=new Date,t="botct-table-".concat(e.getHours(),"_").concat(e.getMinutes(),"_").concat(e.getSeconds(),".png");!function(e,t){var n=document.createElement("a");n.setAttribute("download",t),n.setAttribute("href",e.toDataURL("image/png").replace("image/png","image/octet-stream")),n.click()}(j,t)}}),[j]);return Object(a.useEffect)((function(){j&&E&&function(e,t,n){t.clearRect(0,0,e.width,e.height),t.fillStyle="white",t.fillRect(0,0,e.width,e.height),t.fillStyle="black";var a=d(e),c=h(e,n);t.beginPath(),t.arc(a.x,a.y,a.radius,0,2*Math.PI),t.stroke(),t.font="16px Arial",t.textAlign="center";var r,i=Object(o.a)(c);try{for(i.s();!(r=i.n()).done;){var l=r.value,u=l.x,s=l.y,f=l.player;t.fillText(f.name,u,s+8,100),t.stroke(),f.dead&&(t.beginPath(),t.moveTo(u-25,s-25),t.lineTo(u+25,s+25),t.stroke(),t.beginPath(),t.moveTo(u-25,s+25),t.lineTo(u+25,s-25),t.stroke())}}catch(b){i.e(b)}finally{i.f()}}(j,E,y)}),[j,E,y]),Object(a.useEffect)((function(){var e=setTimeout((function(){localStorage.setItem(b,JSON.stringify({players:y,showTable:n}))}),500);return function(){return clearTimeout(e)}}),[y,n]),n?c.a.createElement("div",{className:"App"},c.a.createElement("canvas",{className:"TableCanvas",width:800,height:800,ref:w,onClick:S}),c.a.createElement("button",{onClick:M},"Export"),c.a.createElement("button",{onClick:T},"Back to Player List")):c.a.createElement("div",{className:"App"},c.a.createElement("ul",{className:"PlayerList"},y.map((function(e){return c.a.createElement("li",{key:e.id,className:"PlayerListItem"},c.a.createElement("input",{className:"PlayerNameInput",value:e.name,onChange:function(t){return P(e.id,t.currentTarget.value)}}),c.a.createElement("button",{className:"PlayerDeleteButton",onClick:function(){return x(e.id)}},"\u2715"))}))),c.a.createElement("button",{onClick:C},"Add Player"),c.a.createElement("button",{onClick:T},"View Table"))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(p,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,n){e.exports=n(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.b6f3d22d.chunk.js.map